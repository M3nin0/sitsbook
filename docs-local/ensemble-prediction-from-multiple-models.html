<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Ensemble prediction from multiple models | sits: Satellite Image Time Series Analysis on Earth Observation Data Cubes</title>
<meta name="author" content="Gilberto Camara">
<meta name="author" content="Rolf Simoes">
<meta name="author" content="Felipe Souza">
<meta name="author" content="Charlotte Pelletier">
<meta name="author" content="Alber Sanchez">
<meta name="author" content="Pedro R. Andrade">
<meta name="author" content="Karine Ferreira">
<meta name="author" content="Gilberto Queiroz">
<meta name="description" content="Ensemble prediction is a powerful technique for combining predictions from multiple models to produce more accurate and robust predictions. In general, ensemble predictions produce better...">
<meta name="generator" content="bookdown 0.35 with bs4_book()">
<meta property="og:title" content="Ensemble prediction from multiple models | sits: Satellite Image Time Series Analysis on Earth Observation Data Cubes">
<meta property="og:type" content="book">
<meta property="og:image" content="/images/cover_sits_book.png">
<meta property="og:description" content="Ensemble prediction is a powerful technique for combining predictions from multiple models to produce more accurate and robust predictions. In general, ensemble predictions produce better...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Ensemble prediction from multiple models | sits: Satellite Image Time Series Analysis on Earth Observation Data Cubes">
<meta name="twitter:description" content="Ensemble prediction is a powerful technique for combining predictions from multiple models to produce more accurate and robust predictions. In general, ensemble predictions produce better...">
<meta name="twitter:image" content="/images/cover_sits_book.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><link href="libs/IBM_Plex_Serif-0.4.7/font.css" rel="stylesheet">
<link href="libs/IBM_Plex_Mono-0.4.7/font.css" rel="stylesheet">
<script src="libs/bs3compat-0.5.1/transition.js"></script><script src="libs/bs3compat-0.5.1/tabs.js"></script><script src="libs/bs3compat-0.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title=""><strong>sits</strong>: Satellite Image Time Series Analysis on Earth Observation Data Cubes</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Preface</a></li>
<li><a class="" href="setup.html">Setup</a></li>
<li><a class="" href="acknowledgements.html">Acknowledgements</a></li>
<li><a class="" href="introduction.html">Introduction</a></li>
<li><a class="" href="earth-observation-data-cubes.html">Earth observation data cubes</a></li>
<li><a class="" href="operations-on-data-cubes.html">Operations on data cubes</a></li>
<li><a class="" href="working-with-time-series.html">Working with time series</a></li>
<li><a class="" href="improving-the-quality-of-training-samples.html">Improving the quality of training samples</a></li>
<li><a class="" href="machine-learning-for-data-cubes.html">Machine learning for data cubes</a></li>
<li><a class="" href="image-classification-in-data-cubes.html">Image classification in data cubes</a></li>
<li><a class="" href="bayesian-smoothing-for-post-processing.html">Bayesian smoothing for post-processing</a></li>
<li><a class="" href="validation-and-accuracy-measurements.html">Validation and accuracy measurements</a></li>
<li><a class="" href="uncertainty-and-active-learning.html">Uncertainty and active learning</a></li>
<li><a class="active" href="ensemble-prediction-from-multiple-models.html">Ensemble prediction from multiple models</a></li>
<li><a class="" href="object-based-time-series-image-analysis.html">Object-based time series image analysis</a></li>
<li><a class="" href="technical-annex.html">Technical Annex</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="ensemble-prediction-from-multiple-models" class="section level1 unnumbered">
<h1>Ensemble prediction from multiple models<a class="anchor" aria-label="anchor" href="#ensemble-prediction-from-multiple-models"><i class="fas fa-link"></i></a>
</h1>
<p>Ensemble prediction is a powerful technique for combining predictions from multiple models to produce more accurate and robust predictions. In general, ensemble predictions produce better predictions than using a single model. This is because the errors of individual models can cancel out or be reduced when combined with the predictions of other models. As a result, ensemble predictions can lead to better overall accuracy and reduce the risk of overfitting. This can be especially useful when working with complex or uncertain data. By combining the predictions of multiple models, users can identify which features or factors are most important for making accurate predictions. When using ensemble methods, choosing diverse models with different sources of error is important to ensure that the ensemble predictions are more accurate and robust.</p>
<p>The <code>sits</code> package provides <code><a href="https://rdrr.io/pkg/sits/man/sits_combine_predictions.html">sits_combine_predictions()</a></code> to estimate ensemble predictions using probability cubes produced by <code><a href="https://rdrr.io/pkg/sits/man/sits_classify.html">sits_classify()</a></code> and optionally post-processed with <code><a href="https://rdrr.io/pkg/sits/man/sits_smooth.html">sits_smooth()</a></code>. There are two ways to make ensemble predictions from multiple models:</p>
<ul>
<li><p>Averaging: In this approach, the predictions of each model are averaged to produce the final prediction. This method works well when the models have similar accuracy and errors.</p></li>
<li><p>Uncertainty: Predictions from different models are compared in terms of their uncertainties on a pixel-by-pixel basis; predictions with lower uncertainty are chosen as the more likely ones to be valid.</p></li>
</ul>
<p>In what follows, we will use the same data set used in Chapter <a href="https://e-sensing.github.io/sitsbook/image-classification-in-data-cubes.html">Image classification in data cubes</a> to illustrate how to produce an ensemble prediction. We will train two models: Random Forest (RF) and Support Vector Machines (SVM), classify the cube with them, and then combine their results. We first make an RF classification</p>
<div class="sourceCode" id="cb181"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Files are available in a local directory</span></span>
<span><span class="va">data_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata/Rondonia-20LMR/"</span>, package <span class="op">=</span> <span class="st">"sitsdata"</span><span class="op">)</span></span>
<span><span class="co"># Read data cube</span></span>
<span><span class="va">ro_cube_20LMR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_cube.html">sits_cube</a></span><span class="op">(</span></span>
<span>  source <span class="op">=</span> <span class="st">"MPC"</span>,</span>
<span>  collection <span class="op">=</span> <span class="st">"SENTINEL-2-L2A"</span>,</span>
<span>  data_dir <span class="op">=</span> <span class="va">data_dir</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># train a random forest model</span></span>
<span><span class="va">rfor_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_train.html">sits_train</a></span><span class="op">(</span><span class="va">samples_deforestation</span>, <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_rfor.html">sits_rfor</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ro_cube_20LMR_rfor_probs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_classify.html">sits_classify</a></span><span class="op">(</span></span>
<span>  <span class="va">ro_cube_20LMR</span>,</span>
<span>  <span class="va">rfor_model</span>,</span>
<span>  output_dir <span class="op">=</span> <span class="st">"./tempdir/chp13"</span>,</span>
<span>  multicores <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  memsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span>  version <span class="op">=</span> <span class="st">"rfor-raster"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">ro_cube_20LMR_rfor_bayes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_smooth.html">sits_smooth</a></span><span class="op">(</span></span>
<span>  <span class="va">ro_cube_20LMR_rfor_probs</span>,</span>
<span>  output_dir <span class="op">=</span> <span class="st">"./tempdir/chp13"</span>,</span>
<span>  multicores <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  memsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span>  version <span class="op">=</span> <span class="st">"rfor-raster"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">ro_cube_20LMR_rfor_class</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_label_classification.html">sits_label_classification</a></span><span class="op">(</span></span>
<span>  <span class="va">ro_cube_20LMR_rfor_bayes</span>,</span>
<span>  output_dir <span class="op">=</span> <span class="st">"./tempdir/chp13"</span>,</span>
<span>  multicores <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  memsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span>  version <span class="op">=</span> <span class="st">"rfor-raster"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">ro_cube_20LMR_rfor_class</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-174"></span>
<img src="sitsbook_files/figure-html/unnamed-chunk-174-1.png" alt="Land classification in Rondonia using a random forest algorithm  (Source: Authors)." width="100%"><p class="caption">
Figure 89: Land classification in Rondonia using a random forest algorithm (Source: Authors).
</p>
</div>
<p>The next step is to classify the same area using an SVM algorithm, as shown below.</p>
<div class="sourceCode" id="cb182"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># train an SVM model</span></span>
<span><span class="va">svm_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_train.html">sits_train</a></span><span class="op">(</span><span class="va">samples_deforestation</span>, <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_svm.html">sits_svm</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># classify the data cube</span></span>
<span><span class="va">ro_cube_20LMR_svm_probs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_classify.html">sits_classify</a></span><span class="op">(</span></span>
<span>  <span class="va">ro_cube_20LMR</span>,</span>
<span>  <span class="va">rfor_model</span>,</span>
<span>  output_dir <span class="op">=</span> <span class="st">"./tempdir/chp13"</span>,</span>
<span>  multicores <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  memsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span>  version <span class="op">=</span> <span class="st">"svm-raster"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">ro_cube_20LMR_svm_bayes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_smooth.html">sits_smooth</a></span><span class="op">(</span></span>
<span>  <span class="va">ro_cube_20LMR_svm_probs</span>,</span>
<span>  output_dir <span class="op">=</span> <span class="st">"./tempdir/chp13"</span>,</span>
<span>  multicores <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  memsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span>  version <span class="op">=</span> <span class="st">"svm-raster"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">ro_cube_20LMR_svm_class</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_label_classification.html">sits_label_classification</a></span><span class="op">(</span></span>
<span>  <span class="va">ro_cube_20LMR_svm_bayes</span>,</span>
<span>  output_dir <span class="op">=</span> <span class="st">"./tempdir/chp13"</span>,</span>
<span>  multicores <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  memsize <span class="op">=</span> <span class="fl">24</span>,</span>
<span>  version <span class="op">=</span> <span class="st">"svm-raster"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">ro_cube_20LMR_svm_class</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-175"></span>
<img src="sitsbook_files/figure-html/unnamed-chunk-175-1.png" alt="Land classification in Rondonia using a support vector machine (Source: Authors)." width="100%"><p class="caption">
Figure 90: Land classification in Rondonia using a support vector machine (Source: Authors).
</p>
</div>
<p>There is a good agreement between the two results, which most of the land areas have been classified similarly. The main differences are in the “Clear_Cut_Burned_Area” and “Clear_Cut_Vegetation”. The RF algorithm tends to be more conservative and finds less areas than SVM. The reason is because RF decision-making uses values from single attributes (values of a single band in a given time instance). Since the Random Forest model is sensitive to the response of images at the end of the period, it tends to focus on values that indicate the presence of forests during the dry season. The SVM model is more balanced to the overall separation of classes in the entire attribute space. Also note that the study area presents many challenges for land classification, given the presence of wetlands, riparian forests and seasonally-flooded areas. Because of this challenge, both methods make mistakes in including flooded areas as “Clear_Cut_Vegetation” in the center-left part of the image.</p>
<p>Given the differences and complementaries between the two predicted outcomes, combining them using <code><a href="https://rdrr.io/pkg/sits/man/sits_combine_predictions.html">sits_combine_predictions()</a></code> is useful. This function takes the following arguments: (a) <code>cubes</code>, a list of the cubes to be combined. These cubes should be probability cubes generated by which optionally may have been smoothened; (b) <code>type</code>, which indicates how to combine the probability maps. The options are <code>average</code>, which performs a weighted mean of the probabilities, and <code>uncertainty</code>, which uses the uncertainty cubes to combine the predictions; (c) <code>weights</code>, a vector of weights to be used to combine the predictions when <code>average</code> is selected; (d) <code>uncertainty_cubes</code>, a list of uncertainty cubes associated to the predictions; (e) <code>multicores</code>, number of cores to be used; (f) <code>memsize</code>, RAM used in the classification; (g) <code>output_dir</code>, the directory where the classified raster files will be written.</p>
<div class="sourceCode" id="cb183"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Combine the two predictions by taking the average of the probabilities for each class</span></span>
<span><span class="va">ro_cube_20LMR_average_probs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_combine_predictions.html">sits_combine_predictions</a></span><span class="op">(</span></span>
<span>  cubes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">ro_cube_20LMR_svm_bayes</span>, <span class="va">ro_cube_20LMR_rfor_bayes</span><span class="op">)</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"average"</span>,</span>
<span>  output_dir <span class="op">=</span> <span class="st">"./tempdir/chp13/"</span>,</span>
<span>  weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.50</span>, <span class="fl">0.50</span><span class="op">)</span>,</span>
<span>  memsize <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  multicores <span class="op">=</span> <span class="fl">4</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Label the average probability cube</span></span>
<span><span class="va">ro_cube_20LMR_average_class</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_label_classification.html">sits_label_classification</a></span><span class="op">(</span></span>
<span>  cube <span class="op">=</span> <span class="va">ro_cube_20LMR_average_probs</span>,</span>
<span>  output_dir <span class="op">=</span> <span class="st">"./tempdir/chp13/"</span>,</span>
<span>  version <span class="op">=</span> <span class="st">"average"</span>,</span>
<span>  memsize <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  multicores <span class="op">=</span> <span class="fl">4</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the second version of the classified cube</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">ro_cube_20LMR_average_class</span>,</span>
<span>  tmap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"scale"</span> <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-176"></span>
<img src="sitsbook_files/figure-html/unnamed-chunk-176-1.png" alt="Land classification in Rondonia using the average of the probabilities produced by Random Forest and SVM algorithms (Source: Authors)." width="100%"><p class="caption">
Figure 91: Land classification in Rondonia using the average of the probabilities produced by Random Forest and SVM algorithms (Source: Authors).
</p>
</div>
<p>Compared with the initial map, the result is more similar to the original SVM map than to the RF result, especially as regards the “Clear_Cut_Burned_Area” class. Such outcome indicates that that SVM is more confident in its predictions than RF when detecting deforestation areas associated with fires. By contrast, the misclassified areas in the center-left part of the map have been reduced. The reason is that some of these areas are indicated in one classifier but not in the other. In this case, the confidence on the deforestation results is not matched by both methods. Thus, in principle, the resulting combined map is more accurate than the individual model outcomes.</p>
<p>A second way to combine the prediction is to use the uncertainty information associated to the probability of each pixel. In this case, the confidence in each prediction is inversely proportional to its uncertainty. For more information on how to compute the uncertainty of prediction, please refer to Chapter <a href="https://e-sensing.github.io/sitsbook/uncertainty-and-active-learning.html">Uncertainty and active learning</a>.</p>
<div class="sourceCode" id="cb184"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate the uncertainty of SVM prediction</span></span>
<span><span class="va">ro_cube_20LMR_svm_uncert</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_uncertainty.html">sits_uncertainty</a></span><span class="op">(</span></span>
<span>  <span class="va">ro_cube_20LMR_svm_bayes</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"margin"</span>,</span>
<span>  output_dir <span class="op">=</span> <span class="st">"./tempdir/chp13/"</span>,</span>
<span>  version <span class="op">=</span> <span class="st">"svm"</span>,</span>
<span>  memsize <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  multicores <span class="op">=</span> <span class="fl">4</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># Calculate the uncertainty of RF prediction</span></span>
<span><span class="va">ro_cube_20LMR_rfor_uncert</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_uncertainty.html">sits_uncertainty</a></span><span class="op">(</span></span>
<span>  <span class="va">ro_cube_20LMR_rfor_bayes</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"margin"</span>,</span>
<span>  output_dir <span class="op">=</span> <span class="st">"./tempdir/chp13/"</span>,</span>
<span>  version <span class="op">=</span> <span class="st">"rfor"</span>,</span>
<span>  memsize <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  multicores <span class="op">=</span> <span class="fl">4</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine the two predictions by taking the average of the probabilities for each class</span></span>
<span><span class="va">ro_cube_20LMR_uncert_probs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_combine_predictions.html">sits_combine_predictions</a></span><span class="op">(</span></span>
<span>  cubes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">ro_cube_20LMR_svm_bayes</span>, <span class="va">ro_cube_20LMR_rfor_bayes</span><span class="op">)</span>,</span>
<span>  uncert_cubes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">ro_cube_20LMR_svm_uncert</span>, <span class="va">ro_cube_20LMR_rfor_uncert</span><span class="op">)</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"uncertainty"</span>,</span>
<span>  output_dir <span class="op">=</span> <span class="st">"./tempdir/chp13/"</span>,</span>
<span>  memsize <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  multicores <span class="op">=</span> <span class="fl">4</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Label the average probability cube</span></span>
<span><span class="va">ro_cube_20LMR_uncert_class</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sits/man/sits_label_classification.html">sits_label_classification</a></span><span class="op">(</span></span>
<span>  cube <span class="op">=</span> <span class="va">ro_cube_20LMR_uncert_probs</span>,</span>
<span>  output_dir <span class="op">=</span> <span class="st">"./tempdir/chp13/"</span>,</span>
<span>  version <span class="op">=</span> <span class="st">"uncertainty"</span>,</span>
<span>  memsize <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  multicores <span class="op">=</span> <span class="fl">4</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the second version of the classified cube</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">ro_cube_20LMR_uncert_class</span>,</span>
<span>  tmap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"scale"</span> <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-177"></span>
<img src="sitsbook_files/figure-html/unnamed-chunk-177-1.png" alt="Land classification in Rondonia using the uncertainty of the probabilities produced by Random Forest and SVM algorithms (Source: Authors)." width="100%"><p class="caption">
Figure 92: Land classification in Rondonia using the uncertainty of the probabilities produced by Random Forest and SVM algorithms (Source: Authors).
</p>
</div>
<p>The result of prediction combination using uncertainty is quite similar to the one produced by the average method. It shows that the SVM method has a higher confidence in its predictions. Overall, ensemble predictions are a powerful tool for improving the accuracy and robustness of machine learning models. By combining the predictions of multiple models, we can reduce errors and uncertainty and gain new insights into the underlying patterns in the data.</p>

</div>
  <div class="chapter-nav">
<div class="prev"><a href="uncertainty-and-active-learning.html">Uncertainty and active learning</a></div>
<div class="next"><a href="object-based-time-series-image-analysis.html">Object-based time series image analysis</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav"><li><a class="nav-link" href="#ensemble-prediction-from-multiple-models">Ensemble prediction from multiple models</a></li></ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong><strong>sits</strong>: Satellite Image Time Series Analysis on Earth Observation Data Cubes</strong>" was written by Gilberto Camara, Rolf Simoes, Felipe Souza, Charlotte Pelletier, Alber Sanchez, Pedro R. Andrade, Karine Ferreira, Gilberto Queiroz. It was last built on 2023-11-06.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
