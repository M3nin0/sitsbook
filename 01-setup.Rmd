# Setup {.unnumbered}

## How to use this on-line book {.unnumbered}

This book contains reproducible code that can be run on an R environment. There are two main options to setup your working environment:

1. Use a Docker image provided by the Brazil Data Cube.
2. Install R and RStudio, and then load the required packages from CRAN.

## Docker images {.unnumbered}

Docker images for `sits` are available from the Brazil Data Cube site:

- [Version for R and RStudio](https://hub.docker.com/r/brazildatacube/sits-rstudio).
- [Version for Jupyter Notebooks] (https://hub.docker.com/r/brazildatacube/sits-jupyter)

On a Windows or Mac platform, install the Docker application and then obtain one of the two images listed above from the Brazil Data Cube. Both images contain the full `sits` running environment. Users have a choice of using an RStudio or a Jupyter notebook interface. 



## Installation from CRAN {.unnumbered}

CRAN, which stands for the Comprehensive R Archive Network, is a network of servers (also known as mirrors) from around the world that store up-to-date, versions of basic code and packages for R. In this case, we suggest a staged installation, as follows:

1. Get base R from [CRAN](https://cran.r-project.org/) 
2. Install RStudio from the [Posit website](https://posit.co/)
3. Configure GDAL and PROJ
4. Install `sits`. 

See below for steps 3 and 4.

### Support for GDAL and PROJ {.unnumbered}

The `sits` package relies on the `sf` and `terra` **R** packages, which require the GDAL and PROJ libraries. Please follow the instructions below for installing `sf` and `terra` together with GDAL, provided by Edzer Pebesma.

Windows and MacOS users are strongly encouraged to install the `sf` and `terra` binary packages from CRAN. To install `sits` from source, please install package `Rtools` to have access to the compiling environment.

For Ubuntu, we recommend using the latest version of the GDAL, GEOS, and PROJ4 libraries and binaries. To do so, use the repository `ubuntugis-unstable`, which should be done as follows:

``` sh
sudo add-apt-repository ppa:ubuntugis/ubuntugis-unstable
sudo apt-get update
sudo apt-get install libudunits2-dev libgdal-dev libgeos-dev libproj-dev 
sudo apt-get install gdal-bin
sudo apt-get install proj-bin
```

Getting an error while adding this PPA repository could be due to the absence of the package `software-properties-common`. When GDAL is running in `docker` containers, please add the security flag `--security-opt seccomp=unconfined` on start. 

For Debian,  use the [rocker geospatial](https://github.com/rocker-org/geospatial) dockerfiles. 

In the case of Fedora, the following command installs all required dependencies:

``` sh
sudo dnf install gdal-devel proj-devel geos-devel sqlite-devel udunits2-devel
```

After installing GDAL, GEOS, and PROJ4, please install packages `sf` and `terra`, in this order.

```{r, eval = FALSE}
install.packages("sf")
install.packages("terra")
```

### Installing the `sits` package {.unnumbered}

After configuring GDAL, GEOS and PROJ4, please proceed to install `sits`,  which is available on CRAN and should be installed as a regular **R** package.

```{r, eval = FALSE}
install.packages("sits", dependencies = TRUE)
```

The source code repository is on [GitHub](https://github.com/e-sensing/sits). To install the development version of `sits`, which contains the latest updates but might be unstable, users should install `devtools`, if not already available, and then install `sits` as follows:

```{r, eval = FALSE}
install.packages("devtools")
devtools::install_github("e-sensing/sits@dev", dependencies = TRUE)
```

To run the examples in the book, please also install the `sitsdata` package.

```{r, eval = FALSE}
options(download.file.method = "wget")
devtools::install_github("e-sensing/sitsdata")
```


## Using GPUs with `sits` {.unnumbered}

The `torch` package automatically recognizes if a GPU is available on the machine and uses it for training and classification. There is a significant performance gain when GPUs are used instead of CPUs for deep learning models. There is no need for specific adjustments to `torch` scripts.  To use GPUs, `torch` requires version 11.6 of the CUDA library, which is available for Ubuntu 18.04 and 20.04. 
 
